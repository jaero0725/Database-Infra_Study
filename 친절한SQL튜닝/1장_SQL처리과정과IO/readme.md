# SQL 처리과정과 I/O
## 1.1 SQL 파싱과 최적화

* 옵티마이저가 SQL을 어떻게 처리하는지? <br>
사용자 -(SQL)-> 옵티마이저 -(실행계획)-> 프로시저 <br>
- 옵티마이저가 프로그래밍을 대신해줌
- DBMS 내부에서 프로시저를 작성하고 컴파일 해서 실행 가능한 상태로 만드는 전 과정을 'SQL 최적화'라고 함. 

### 1.1.2 SQL 최적화 (SQL을 실행하기 전 최적화 과정은?)
1) SQL 파싱 (SQL Parser가 진행)
- 사용자에게 SQL을 전달받으면 가장 먼저 SQL Parser가 파싱을 진행한다. 
- 파싱트리 생성 : SQL 문을 이루는 개별 구서용소를 분석해서 파싱 트리 생성
- Syntax 체크 : 문법적 오류가 없는지 확인. 사용할 수 없는 키워드 사용했는지, 순서가 올바르지 않은지 확인
- Semantic 체크 : 의미상 오류가 없는지 확인. 존재하지 않는 테이블 또는 컬럼 사용했는지, 권한 체크

2) SQL 최적화 (Optimizer가 진행)
- 옵티마이저가 미리 수집한 및 오브젝트 통계정보를 바탕으로 다양한 실행경로를 생성해서 비교한 후 가장 효율적인 하나를 선택.
- DB 성능을 결정하는 가장 핵심적인 엔진

3) 로우 소스 생성 (로우 소스 생성기 Row-Souce Generatorr가 진행)
- SQL옵티마이저가 선택한 실행경로를 실제 실행 가능한 코드 또는 프로시저 형태로 포맷팅 하는 단계. 

### 1.1.3 SQL옵티마이저 
-최적의 데이터 엑세스 경로를 선택해 주는 DBMS의 핵심 엔진 
![image](https://user-images.githubusercontent.com/55049159/232272299-6a4fb047-bf67-4938-9ddc-40a6d3418734.png)
1) 사용자로부터 전달받은 쿼리를 수행하는 데 후보군이 될만한 실행계획들을 찾아낸다.
2) 데이터 딕셔너리(Data Dictionary)에 미리 수집해 둔 오브젝트 통계 및 시스템 통계 정보를 이용해 각 실행계획의 예상비용을 산정한다.
3) 최저 비용을 나타내는 실행계획을 선택한다. 

### 1.1.5 옵티마이저 힌트 
* 주의사항
* 콤마사용 X
* 스키마명 X
* Alias 썼으면 그대로 쓰기 
<hr>
## 1.2 SQL 공유 및 재사용
* SQL 문제  : SQL 에서 소프트 파싱과 하드 파싱의 차이점에 대해서 설명해주실 수 있나요?
```
먼저 SQL 실행은 파싱(파서에의해) -> 최적화(옵티마이저에의해) -> 로우 소스(로우소스 생성기) 생성과정으로 진행되는데
이런 과정을 거치면, SGA영역에 있는 '라이브러리 캐시'에 저장되어 반복 재사용할 수 있게 됩니다. 
파싱을 하고 라이브러리캐시에서 존재하는지 확인하고 저장되어있자면 바로 실행 되는 것이 "소프트 파싱" 이라고 합니다.
반면 라이브러리 캐시에 존재하지 않는다면 최적화, 로우소스 생성 과정을 거쳐 실행되는 데 이것을 "하드 파싱" 이라고 합니다. 
```

SQL파싱, 최적화, 로우 소스 생성과정 거쳐 생성한 내부 프로시저를 반복 재사용할 수 있도록 해두는 메모리 공간을 SGA에 있는 라이브러리 캐시라고 합니다. <br>

```

사용자가 SQL문을 전달하면 DBMS는 SQL을 파싱한후 SQL이 라이브러리 캐시에 존재하는지 확인한다.
캐시에서 찾으면 곧바로 실행 단계로 넘어가지만, 찾지 못하면 최적화 단계를 거칩니다. 
SQL을 캐시에서 찾아 곧바로 실행단계로 넘어가는 것을 '소프트 파싱'이라고 하고, 
찾는데 실패해 최적화 및 로우 소스 생성 단계까지 모두 거치는 것을 '하드파싱 이라고 합니다. 

```
![image](https://user-images.githubusercontent.com/55049159/232272982-d866f0af-f0d6-470a-b881-6bc2ad1ad9bd.png)



